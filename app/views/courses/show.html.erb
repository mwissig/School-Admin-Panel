<% if logged_in? %>

  <h1>Course</h1>
  <%= form_for @course do |f| %>
  <%= f.text_field :name, placeholder: "Course Name", required: true %>
  Hours:
  <%= f.number_field :hours, placeholder: 0, :class => 'text_field', :step => 10, required: true %>
  <%= f.submit 'Edit Course' %>
<% end %>
<h2>Cohorts in this Course</h2>
<% if @course.cohorts != nil %>
  <% if @course.cohorts.length > 0 %>
    <% @course.cohorts.each do |coh| %>

      <% @num_stu = 0 %>
        <% @students.each do |s| %>
          <% if coh.id == s.cohort_id %>
            <% @num_stu += 1 %><% end %>
          <% end %>

          <% @coursename = Course.find_by(id: coh.course_id) %>
            <p class="desc">Date:
              <%= coh.start_date.to_datetime.strftime("%m/%e/%y") %>
              to
              <%= coh.end_date.to_datetime.strftime("%m/%e/%y") %>
              <p>

                <%= form_for coh do |f| %>
                <%= @coursename.name %>
                <%= f.text_field :name%>

                <%= f.text_field :start_date, class: 'datefield' %>
                to
                <%= f.text_field :end_date, class: 'datefield' %>
    <%= f.select :user_id, @instructorsarray %>
                <%= f.submit 'Edit Cohort' %>
                <%= @num_stu %>
                students.
                <%= link_to "View #{coh.name}", cohort_path(coh) %>
              <% end %>
            <% end %>
          <% else %>
            <p>This course has no cohorts.</p>
          <% end %>
        <% end %>
        <h2>Add Cohort to This Course</h2>
        <% if current_user.admin_priv == 0 %>
          <p>This form will assign you as the instructor for this cohort.</p>
          <%= form_for @newcohort do |f| %>
          <%= f.hidden_field :course_id, value: @course.id %>
          <%= f.text_field :name, placeholder: "Name"%>
          <%= f.date_field :start_date %>
          to
          <%= f.date_field :end_date %>
          <%= f.hidden_field :user_id, value: current_user.id %>
          <%= f.submit 'Create Cohort' %>
        <% end %>
      <% else %>
        <%= form_for @newcohort do |f| %>
        <%= f.hidden_field :course_id, value: @course.id %>
        <%= f.text_field :name, placeholder: "Name"%>
        <%= f.date_field :start_date %>
        to
        <%= f.date_field :end_date %>
        <%= f.select :user_id, @instructorsarray %>
        <%= f.submit 'Create Cohort' %>
      <% end %>
    <% end %>

  <% end %>
